@page "/upload"

<h3>Upload Document</h3>

<div class="mb-3">
    <label class="form-label">Choose Document (PDF or CSV only)</label>
    <InputFile OnChange="HandleFileUpload" />   @* FIXED *@
</div>

<div class="mb-3">
    <label class="form-label">Select Office</label>
    <select class="form-select" @bind="SelectedOffice">
        @foreach (var office in Offices)
        {
            <option value="@office">@office</option>
        }
    </select>
</div>

<button class="btn btn-success" @onclick="UploadFile">Upload</button>

@if (!string.IsNullOrEmpty(Message))
{
    <div class="alert alert-info mt-3">@Message</div>
}

@code {
    private IBrowserFile? SelectedFile;
    private string SelectedOffice = "HR";
    private string Message = "";

    private List<string> Offices = new()
    {
        "HR", "Accounting", "Admin", "Supply"
    };

    // ‚ùó ONCHANGE method must take InputFileChangeEventArgs
    private void HandleFileUpload(InputFileChangeEventArgs e)
    {
        SelectedFile = e.File;
    }

    private async Task UploadFile()
    {
        if (SelectedFile == null)
        {
            Message = "Please select a file.";
            return;
        }

        if (!(SelectedFile.ContentType == "application/pdf" ||
              SelectedFile.ContentType == "text/csv"))
        {
            Message = "Only PDF or CSV files are allowed.";
            return;
        }

        // Real saving later
        Message = $"File '{SelectedFile.Name}' uploaded to '{SelectedOffice}'.";
    }
}